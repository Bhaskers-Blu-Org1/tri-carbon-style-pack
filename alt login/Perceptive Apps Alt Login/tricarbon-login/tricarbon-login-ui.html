<!--
@license
IBM Confidential - OCO Source Materials - (C) COPYRIGHT IBM CORP. 2015-2016 - The source code for this program is not published or otherwise divested of its trade secrets, irrespective of what has been deposited with the U.S. Copyright Office.
-->
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">

<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-card/paper-card.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<!--<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans">-->


<dom-module id="tricarbon-login-ui">
<!-- <link rel="import" type="css" href="denim.css"> -->
<!-- <link rel="import" type="css" href="style.css"> -->
	<template>
		<style id="myStyles" include="iron-flex iron-flex-alignment">
		@font-face {
		  font-family: ibmPlexSans;
		  src: url(https://fonts.gstatic.com/s/ibmplexsans/v7/zYXgKVElMYYaJe8bpLHnCwDKhdHeFaxOedc.woff2);
		}
			:host {
				--login-font-family: ibmPlexSans;
				font-family: var(--login-font-family);
				/* @apply(--layout-vertical); */
			}

			.bg-picture {
				position: fixed;
				min-height: 100%;
				top: 42px;
				left: 0;
				right: 0;
				z-index: -1;
				background-image: url('images/BuildingsLowResBlur.svg');
				background-size: cover;
			}

			.bg-picture:after {
				position: absolute;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
				content: "";
				display: block;
				background-size: cover;
				background-image: url('images/Buildings.jpg');
				transition-property: opacity;
				transition-duration: 2s;
				transition-timing-function: ease;
				opacity: 0;
			}

			.bg-picture[enhanced]:after {
				opacity: 1;
			}

			.page-title{
				width: 100%;
				height: 42px;
				line-height: 42px;
				background-color: #171717;
				position: absolute;
				left: 0px;
				top: 0px;
				color: whitesmoke;
				font-family: ibmPlexSans;
				font-weight: bold;
				font-size: 16px;
				padding: 0px 0px 0px 8px;
			}

			/* #container {
				@apply(--layout-horizontal);
				@apply(--layout-center-justified);
				@apply(--layout-start);
			} */

			paper-card {
				width: 400px;
				margin-top: 120px;
				padding: 2em;
				border-radius: 0px;
				/* background-color: #ffffff !important; */
			}

			.button-container {
				margin-top: 30px;
			}

			.error, .processing {
				font-size: 13px;
				text-align: center;
				padding-top: 16px;
				padding-bottom: 16px;
			}
			.processing {
				color: grey;
			}
			.error {
				color: #da1e28;
			}
			#loginLogo{
				position: relative;
				padding-bottom: 1em;
				background-repeat:no-repeat;
				float: right;
			}
			#loginTitle {
				font-weight: normal;
				font-size:20px;
				/* padding-bottom: 18px; */
				color: #171717;
				margin-bottom: 0px;
				margin-top: 0px;
				clear: left;
			}

			.loginButton{
	    		-webkit-appearance: none;
	  			-webkit-border-radius: 0;
				margin-top: 20px;
				color: #f0f1e2;
				background-color:#0062ff ;
				border:2px;
				width:130px;
				height:30px;
			}

			#footerWrapper{
				margin-top: 3em;
				min-height:120px;
				width:100%;
			}
			#footer{
				background-color:#171717;
				opacity: .9;
				width:100%;
				height:100%;
				padding-top:16px;
				padding-bottom:16px;
				font-size:12px;
				min-height: 100px;
			}
			#tririgaLegal{
			    font-weight: normal;
			    font-size: 10px;
			    color: #999999;

				margin-left: 15%;
				margin-right: 15%;
			}
			#tririgaLegal a:link{
				color: #999999;
			}

		paper-button {

				font-size: small;
				text-transform: none;
				color: #ffffff;
				background-color : #0062ff;
				height: 30px;
				Width: 80px;
				font-family: ibmPlexSans;
				/* border:2px solid #90a4ae;  */
				/* font-weight: bold; */
				border-radius:0;
				margin: 0px;
				--paper-button: {
					@apply(--layout-horizontal);
					@apply(--layout-start-justified);
					/* font-family: var(--login-font-family);  */
				};
			}



		    .msgButtonAffirm{
		    	-webkit-appearance: none;
	  			-webkit-border-radius: 0;
				color: #003e68;
				background-color : #ffffff;
				border:2px solid #003e68;
				height:30px;
				font-weight: bold;
			}

			paper-input {
				width: 90%;
				--paper-input-container-input: {
					font-family: var(--login-font-family);
					font-size:12px;
					background-color: #f3f3f3;
				};
				--paper-input-container-label: {
					font-family: var(--login-font-family);
				};
			}

		    #dialogHeader{
                height: 2em;
                background: #003e68;
                margin: 0;
                padding-top: .8em;
                padding-bottom: .2em;
                padding-left: 1em;
                padding-right: .1em;
                color: white;
                font-size: 1.2em;
                font-weight: bold;
                line-height: 15px;

            }

            #dialogBody{
                margin-top: .5em;
                padding: 10px 15px;
                font-size:small;
                color:#4C4C4C;
                text-align:justify;
                line-height: 15px;
            }

            papaer-dialog {
                margin-bottom: -2em;
                width: 310px;
                background-color: rgba(255, 255, 255, 1);
                max-height: 400px;
                top:22.5% !important;
                white-space: normal;

            }

            .activeUser {
                color: #FFFFC2;
			}

			#content {
				margin-top: 120px !important;
				margin-left: auto;
				margin-right: auto;
			}

			#loginBox {
				height: 228px;
				width: 350px;
				padding: 48px;
				margin-left: auto;
				margin-right: auto;
			}

			#loginInput {
					margin-top: 19px;
				}


        @media (min-height: 750px) {
	   #footerWrapper{
	        position: fixed;
					left: 0 !important;
					bottom: 0 !important;
		  }
		}

		@media (max-height: 749px) {
		  	#content {
				margin-top: 58px !important;
				margin-left: auto;
				margin-right: auto;
			}
			#footerWrapper{
	      position: fixed;
				left: 0 !important;
				bottom: 0 !important;
		  	}
		}

		@media (max-height: 470px) {
			#footer {
				visibility:hidden;
			}
		}

	    /* #content {
	    	margin: auto;
	    	width: 464px;
	    } */

	    @media (max-width: 499px) {
		    #content {
				margin-top: 58px !important;
		    	margin: auto;
		    	width: 90%;
			}

			#loginBox {
				height: 250px;
				width: 90%;
				padding: 16px;
			}

		    #tririgaLegal{
				margin-left: 5%;
				margin-right: 5%;
			}
			.error {
				padding-left: 0;
			}

			#loginTitle {
				font-size:20px;
		   	}

		   	paper-material {
				background-size: 200px;
			}

			.loginButton{
				margin-top: 0;
			}

			paper-input-container {
				width: 50%;
			}
			#footerWrapper{
				position: fixed;
				bottom: 0 !important;
				left: 0 !important;
	      	}
	      	paper-material{
	      		margin-top: 0;
	      	}

	    }
	    @media (max-width: 375px) {
		    #content {
				margin-top: 58px !important;
		    	margin: auto;
				width: 90%;
			}
			#loginBox {
				height: 250px;
				width: 90%;
				padding: 16px;
			}
	    }

	    @media (max-width: 325px) {
		    #content {
				margin-top: 42px !important;
				margin-left: auto;
				margin-right: auto;
				width: 320px;
		    }
		    #tririgaLegal{
				margin-left: 5%;
				margin-right: 5%;
			}

			paper-input-container {
				width: 50%;
			}

			/*paper-button {
				font-size: .7em;
				padding: 0.5em 0.57em;
			} */
	    }

		@media only screen
			and (min-device-width : 768px)
			and (max-device-width : 1024px)
			{
				 /* #content {
				 	width: 768px;

			    } */
			    #footer{
				    min-height: 120px;
	      		}

		      	/* paper-material{
		      		margin: 5% 5% 5% 5%;
		      		background-position:90% 120% !important;
		      		background-size: 20em 30em;
		      	} */
		      	#loginLogo{
					position: relative;

					background-repeat:no-repeat;
				}

				#loginInput input {
					font-size:18px !important;
				}
				#loginInput label {
					font-size:22px !important;s
				}
				#loginTitle {
					font-size: 20px;
				}
				.loginButton{
					width:160px;
					height:60px;
					font-size: 20px;
				}
				.error, .processing {
					font-size: 13px;
					text-align: center;
					padding-top: 3em;
					padding-top: 16px;
					padding-bottom: 16px;
				}
				/* #loginMain{
					@apply(--layout-horizontal);
    				@apply(--layout-center-justified);
				} */

			}
		</style>
		<div id="bgDiv" class="bg-picture" enhanced$="[[_imagesLoaded]]"></div>
		<div id=pageTitle class="page-title">[[loginTitle]]</div>
		<template is="dom-if" if="[[!_imagesLoaded]]" restamp>
			<img hidden src="images/BuildingsLowResBlur.svg" on-load="_handleLoadLowRes">
			<img hidden src="images/Buildings.jpg" on-load="_handleLoadHighRes">
		</template>

		<div id="content">

			<!-- <div id=pageTitle class="page-title">[[loginTitle]]</div> -->
			<!-- <paper-card class = "hero" z="1" elevation="5"> -->

				<div id="loginBox" style="background-color:#ffffff;">
					<!-- <img id="loginLogo" src="images/login_logo.png"/><br> -->
					<div id="loginTitle">Log in to IBM TRIRIGA</div>
					<div id="loginInput">
						<paper-input label = "User ID" value="{{username}}" auto-validate on-keypress="_keyPressHandler"
						             tabIndex="1" autofocus required always-float-label></paper-input>
						<paper-input label = "Password" value="{{password}}" auto-validate type="password" on-keypress="_keyPressHandler"
						             tabIndex="2" required always-float-label></paper-input>
					</div>
					<div class="layout horizontal button-container">
							<paper-button tabIndex="3" on-tap="_handleLoginTap">Log In</paper-button>
					</div>
					<div class="layout horizontal">
							<div class="flex layout vertical">
								<template is="dom-if" if="{{_logging}}">
									<div class="processing">Logging in...</div>
								</template>
								<template is="dom-if" if="{{_unauthorized}}">
									<div id="error" class="error">Invalid User ID or Password.</div>
								</template>
								<template is="dom-if" if="{{_error}}">
									<div id="error" class="error">Login failed</div>
								</template>
							</div>
					</div>
				</div>

			<!-- </paper-card> -->
		</div>
		<paper-dialog id="message" modal>
		    <div id="dialogHeader">The user <span class="activeUser">{{username}}</span> is already active.</div>
		    <div id="dialogBoday">
		    	<div class="flex layout vertical">
					<div>You may end the active session or click cancel to log in as another user.</div>
				</div>
		    </div>

		    <div class="buttons">
		        <paper-button id="forceLogin" class="msgButtonAffirm" on-tap="_handleForceLogin">End Active Session</paper-button>&nbsp;
		        <paper-button id="closeDialog" class="msgButtonAffirm" on-tap="_closeDialog">Cancel</paper-button>
		    </div>
		</paper-dialog>

		<div id="footerWrapper">
			<div id='footer'>
				<div id='tririgaLegal'>
					<div>
						<p style='margin:0px;margin-top:5px;' translate="no">
						Licensed Materials - Property of IBM (c) Copyright IBM Corp. 1997, 2015  All Rights Reserved. IBM, the IBM logo, ibm.com and TRIRIGA are trademarks or registered trademarks of International Business Machines Corp., registered in many jurisdictions worldwide. Other product and service names might be trademarks of IBM or other companies. A current list of IBM trademarks is available on the Web at <a href="http://www.ibm.com/legal/copytrade.shtml">Copyright and trademark information</a>.
						</p>
					</div>
					<div class="layout horizontal">
						<table>
							<tr>
						    	<td>
						    		<div class="flex1" style="padding-top:1em; padding-right:2em;">
										<img src='images/csi_logo.png'/>
									</div>
						    	</td>
						    	<td>
						    		<div class="flex5">
										<p translate="no" style='margin:0px;margin-top:5px;'>
										<i>MasterFormat</i><sup>&reg;</sup> is produced jointly by CSI and Construction Specifications Canada (CSC). U.S. copyright is held by CSI and Canadian copyright by CSC. All Rights Reserved. For license information, contact CSI at csi@csinet.org. For more information on MasterFormat visit <a href="http://www.MasterFormat.com">www.MasterFormat.com</a>.
										</p>
									</div>
						    	</td>
						  	</tr>
						</table>
					</div>
					<div>
						<p style='margin-top:0px;margin-top:5px;' translate="no">Portions copyright (C) Free Software Foundation, Inc 1991, 1999.</p>
					</div>
				</div>
			</div>
		</div>
	</template>
</dom-module>
<script>
	Polymer({

		is: "tricarbon-login-ui",

	      /* disable triplat-theme */

		properties: {

			username: {
				type: String,
				notify: true,
				readOnly: false,
				value:""
			},

			password:  {
				type: String,
				notify: true,
				readOnly: false,
				value: ""
			},

			loginTitle: {
				type: String,
				notify: false,
				readOnly: false,
				value:"UX Alt Login Page"
			},

			_imagesLoaded: {
				type: Boolean,
				value: false
			},

			_loadedLowRes: {
				type: Boolean,
				value: false
			},

			_loadedHighRes: {
				type: Boolean,
				value: false
			}
		},

		showAlreadyLoggedMessage: function() {
			this.$.message.open();
			this._logging = false;
			this.async(
				function(){
					this.$.forceLogin.focus();
				}.bind(this),100
			);
		},

		showUnauthorizedMessage: function() {
			this._unauthorized = true;
			this._logging = false;
		},

		showErrorMessage: function() {
			this._error = true;
			this._logging = false;
		},

		_handleLoginTap: function(e) {
			this._logging = true;
			this._unauthorized = false;
			this._error = false;
			this.fire('login', e);
		},

		_handleForceLogin: function(e){
			this.fire('force-login', e);
		},

		_keyPressHandler: function(e) {
        	var code = event.keyCode;
        	if (code == 13) {
        		this._handleLoginTap(e);
        	}
        },

		_closeDialog: function(){
			this.$.message.close();
		},

		_handleLoadLowRes: function() {
			this._loadedLowRes = true;
			this.computeImagesLoaded();
		},

		computeImagesLoaded: function() {
			if (this._loadedLowRes && this._loadedHighRes) this.async(() => this._imagesLoaded = true, 1000);
		},

		_handleLoadHighRes: function() {
			this._loadedHighRes = true;
			this.computeImagesLoaded();
		}
	});
</script>
